<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alzheimer's Prediction Tool | AlzPredict</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .upload-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 40px;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 40px;
            margin: 20px 0;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            background-color: #f8f9fa;
            overflow: hidden;
        }
        
        .upload-area:hover {
            border-color: var(--primary-color);
            background-color: #f0f7ff;
        }
        
        .upload-area.highlight {
            border-color: var(--primary-color);
            background-color: #f0f7ff;
            box-shadow: 0 0 10px rgba(0, 123, 255, 0.2);
        }
        
        .upload-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        
        .upload-area:hover .upload-icon {
            transform: scale(1.1);
        }
        
        .file-input {
            display: none;
        }
        
        .upload-instructions {
            margin: 20px 0;
            color: #6c757d;
            font-size: 0.95rem;
        }
        
        .format-info {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .format-item {
            background-color: #f1f3f5;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .format-item i {
            color: var(--primary-color);
        }
        
        .size-info {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 10px;
        }
        
        .upload-btn {
            margin-top: 25px;
            transition: all 0.3s ease;
            padding: 12px 30px;
            font-size: 1.1rem;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .upload-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .file-preview-container {
            margin: 20px auto;
            max-width: 400px;
            position: relative;
            display: none; /* Initially hidden */
        }
        
        .file-preview {
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            object-fit: contain;
            max-height: 300px;
        }
        
        .file-info {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            text-align: left;
            border: 1px solid #e9ecef;
        }
        
        .file-name {
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-meta {
            font-size: 0.85rem;
            color: #6c757d;
            display: flex;
            justify-content: space-between;
        }
        
        .remove-file {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #dc3545;
            border: none;
            transition: all 0.2s ease;
        }
        
        .remove-file:hover {
            background-color: #dc3545;
            color: white;
        }
        
        .results-container {
            display: none;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 40px;
            margin-top: 40px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .results-title {
            margin: 0;
        }
        
        .results-actions {
            display: flex;
            gap: 15px;
        }
        
        .results-content {
            display: flex;
            gap: 30px;
        }
        
        .results-image {
            flex: 1;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .results-image img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 8px;
        }
        
        .results-details {
            flex: 1;
        }
        
        .prediction-result {
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 20px;
            text-align: center;
            border-left: 5px solid var(--primary-color);
        }
        
        .prediction-stage {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .confidence-container {
            margin: 20px 0;
        }
        
        .confidence-label {
            margin-bottom: 10px;
            font-weight: 500;
            font-size: 1.1rem;
        }
        
        .confidence-bar {
            height: 15px;
            background-color: #e9ecef;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .confidence-level {
            height: 100%;
            background: linear-gradient(to right, #5cb85c, #4CAF50);
            border-radius: 10px;
            transition: width 1s ease-in-out;
        }
        
        .confidence-text {
            text-align: right;
            font-weight: 500;
            color: #4CAF50;
        }
        
        .file-preview {
            max-width: 300px;
            max-height: 200px;
            margin: 15px auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .file-preview:hover {
            transform: scale(1.05);
        }
        
        .selected-file-name {
            background-color: #e9ecef;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #495057;
        }
        
        .camera-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .camera-container {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        #cameraFeed {
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transform: scaleX(-1); /* Mirror effect for selfie view */
        }
        
        .disclaimer {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 30px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .how-it-works {
            margin-top: 60px;
        }
        
        .steps {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        .step {
            flex: 1;
            text-align: center;
            padding: 0 20px;
            position: relative;
        }
        
        .step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 40px;
            right: 0;
            width: 100%;
            height: 2px;
            background-color: var(--border-color);
            z-index: -1;
        }
        
        .step-number {
            width: 80px;
            height: 80px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        .step h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .results-content {
                flex-direction: column;
            }
            
            .steps {
                flex-direction: column;
                gap: 30px;
            }
            
            .step:not(:last-child)::after {
                display: none;
            }
        }
        
        .caution-note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            border-radius: var(--border-radius);
        }
        
        .caution-note i {
            color: #ffc107;
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .caution-note p {
            margin: 0;
            color: #856404;
        }
        
        .sample-images {
            margin: 30px 0;
        }
        
        .sample-images h3 {
            margin-bottom: 15px;
            color: var(--text-color);
        }
        
        .sample-images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .sample-image {
            background: var(--card-bg);
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }
        
        .sample-image:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .sample-image img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: var(--border-radius);
            margin-bottom: 10px;
        }
        
        .sample-image p {
            text-align: center;
            margin: 0;
            color: var(--text-light);
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            .sample-images-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .sample-image img {
                height: 120px;
            }
        }
        
        .recommendations-container {
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 25px;
            margin: 20px 0;
        }
        
        .recommendations-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .recommendations-content {
            display: grid;
            gap: 15px;
        }
        
        .recommendation-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }
        
        .recommendation-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .recommendation-item i {
            color: var(--primary-color);
            font-size: 1.2em;
            margin-top: 3px;
        }
        
        .recommendation-item p {
            margin: 0;
            color: var(--text-color);
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .recommendation-item {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .recommendation-item i {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1>AlzPredict</h1>
            </div>
            <nav>
                <button class="mobile-menu-btn" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">Learn About Alzheimer's</a></li>
                    <li><a href="prediction-tool.html" class="active">Prediction Tool</a></li>
                    <li><a href="success-stories.html">Success Stories</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h2>Alzheimer's Stage Prediction Tool</h2>
                    <p>Upload a brain scan image to get an AI-powered analysis of potential Alzheimer's disease indicators and stage prediction.</p>
                </div>
                <div class="hero-image">
                    <img src="pictures\rsz_1brain_scan_visualization.jpg" alt="MRI scan analysis visualization" width="600" height="400">
                </div>
            </div>
        </section>

        <!-- Upload Section -->
        <section class="upload-section">
            <div class="container">
                <div class="upload-container">
                    <h2>Upload MRI Scan</h2>
                    <div class="caution-note">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Important: Please upload only brain MRI scan images. Other types of medical images may not provide accurate results.</p>
                    </div>
                    
                    <div class="sample-images">
                        <h3>Sample MRI Scans</h3>
                        <div class="sample-images-grid">
                            <div class="sample-image">
                                <img src="Test Images\ModerateDemented\moderateDem40.jpg" alt="Brain MRI Scan">
                                <p>Sample MRI Scan 1</p>
                            </div>
                            <div class="sample-image">
                                <img src="Test Images\NonDemented\nonDem2511.jpg" alt="Brain MRI Scan">
                                <p>Sample MRI Scan 2</p>
                            </div>
                            <div class="sample-image">
                                <img src="Test Images\MildDemented\mildDem707.jpg" alt="Brain MRI Scan">
                                <p>Sample MRI Scan 3</p>
                            </div>
                            <div class="sample-image">
                                <img src="Test Images\NonDemented\nonDem2524.jpg" alt="Brain MRI Scan">
                                <p>Sample MRI Scan 4</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-area" id="dropArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Drag & Drop Files Here</h3>
                        <p>or</p>
                        <input type="file" id="fileInput" class="file-input" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff,.dicom">
                        <button class="btn btn-secondary" onclick="document.getElementById('fileInput').click()">Browse Files</button>
                        
                        <div class="upload-instructions">
                            Select a high-quality MRI scan image for the most accurate results
                        </div>
                    </div>
                    
                    <div class="file-preview-container" id="previewContainer">
                        <img class="file-preview" id="imagePreview">
                        <button class="remove-file" id="removeFile"><i class="fas fa-times"></i></button>
                        <div class="file-info">
                            <div class="file-name" id="fileName">image.jpg</div>
                            <div class="file-meta">
                                <span id="fileType">Image</span>
                                <span id="fileSize">0 KB</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="format-info">
                        <div class="format-item"><i class="fas fa-file-image"></i> JPEG</div>
                        <div class="format-item"><i class="fas fa-file-image"></i> PNG</div>
                        <div class="format-item"><i class="fas fa-file-image"></i> TIFF</div>
                        <div class="format-item"><i class="fas fa-file-medical"></i> DICOM</div>
                    </div>
                    <div class="size-info">Maximum file size: 50MB</div>
                    
                    <button class="btn btn-primary upload-btn" id="uploadBtn" disabled>Analyze Scan</button>
                </div>
                
                <!-- Results Section -->
                <div class="results-container" id="resultsContainer">
                    <div class="results-header">
                        <h2 class="results-title">Analysis Results</h2>
                        <div class="results-actions">
                            <button class="btn btn-secondary"><i class="fas fa-download"></i> Download Report</button>
                            <button class="btn btn-secondary"><i class="fas fa-share-alt"></i> Share Results</button>
                        </div>
                    </div>
                    
                    <div class="results-content">
                        <div class="results-image">
                            <img src="pictures/rsz_1brain_scan_visualization.jpg" alt="Analyzed MRI scan with highlighted regions" id="resultImage">
                        </div>
                        <div class="results-details">
                            <div class="prediction-result">
                                <h3>Prediction:</h3>
                                <div class="prediction-stage" id="predictionStage">Analyzing...</div>
                                <div class="confidence-container">
                                    <div class="confidence-label">Confidence Level:</div>
                                <div class="confidence-bar">
                                        <div class="confidence-level" id="confidenceLevel" style="width: 0%;"></div>
                                </div>
                                    <div class="confidence-text" id="confidenceText">Calculating...</div>
                                </div>
                            </div>
                            
                            <!-- Stage-specific recommendations -->
                            <div class="recommendations-container" id="recommendationsContainer">
                                <h3>Recommended Actions</h3>
                                <div class="recommendations-content">
                                    <!-- NonDemented Recommendations -->
                                    <div class="stage-recommendations" id="nonDementedRecs" style="display: none;">
                                        <div class="recommendation-item">
                                            <i class="fas fa-brain"></i>
                                            <p>Stay Mentally Active: Engage in reading, puzzles, learning new skills.</p>
                                </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-running"></i>
                                            <p>Maintain Physical Health: Regular exercise and a balanced diet.</p>
                                </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-users"></i>
                                            <p>Stay Socially Connected: Meet friends and family often.</p>
                                </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-bed"></i>
                                            <p>Healthy Sleep Habits: 7â€“9 hours of quality sleep.</p>
                                </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-stethoscope"></i>
                                            <p>Routine Check-ups: Regular health screenings.</p>
                                        </div>
                                    </div>

                                    <!-- VeryMildDemented Recommendations -->
                                    <div class="stage-recommendations" id="veryMildDementedRecs" style="display: none;">
                                        <div class="recommendation-item">
                                            <i class="fas fa-calendar-alt"></i>
                                            <p>Stay Organized: Use calendars, notes, and alarms to keep track.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-puzzle-piece"></i>
                                            <p>Continue Cognitive Activities: Brain games, memory exercises.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-utensils"></i>
                                            <p>Healthy Lifestyle Choices: Prioritize heart-healthy and brain-healthy diets.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-spa"></i>
                                            <p>Manage Stress: Practice mindfulness, yoga, or relaxation techniques.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-user-md"></i>
                                            <p>Regular Doctor Visits: Monitor memory and cognitive changes closely.</p>
                                        </div>
                                    </div>

                                    <!-- MildDemented Recommendations -->
                                    <div class="stage-recommendations" id="mildDementedRecs" style="display: none;">
                                        <div class="recommendation-item">
                                            <i class="fas fa-tasks"></i>
                                            <p>Simplify Tasks: Break activities into small, manageable steps.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-clock"></i>
                                            <p>Establish Routines: Stick to daily schedules for familiarity.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-sticky-note"></i>
                                            <p>Use Memory Aids: Labels, lists, and reminder apps.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-shield-alt"></i>
                                            <p>Safety First: Remove tripping hazards, install grab bars if needed.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-paint-brush"></i>
                                            <p>Stay Engaged: Encourage hobbies like painting, gardening, light activities.</p>
                                        </div>
                                    </div>

                                    <!-- ModerateDemented Recommendations -->
                                    <div class="stage-recommendations" id="moderateDementedRecs" style="display: none;">
                                        <div class="recommendation-item">
                                            <i class="fas fa-list-ol"></i>
                                            <p>Provide Clear Instructions: Simple, one-step directions work best.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-home"></i>
                                            <p>Create a Calm Environment: Reduce noise, clutter, and distractions.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-heart"></i>
                                            <p>Offer Emotional Support: Patience, reassurance, and gentle conversations.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-hands-helping"></i>
                                            <p>Assist with Daily Tasks: Help with dressing, bathing, and meals as needed.</p>
                                        </div>
                                        <div class="recommendation-item">
                                            <i class="fas fa-heartbeat"></i>
                                            <p>Monitor Physical Health: Ensure they eat, drink water, and move safely.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="disclaimer">
                                <strong>Medical Disclaimer:</strong> This tool provides an automated analysis and is not a substitute for professional medical diagnosis. Please consult with a healthcare provider to discuss these results.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- How It Works Section -->
                <div class="how-it-works">
                    <h2>How It Works</h2>
                    
                    <div class="steps">
                        <div class="step">
                            <div class="step-number">1</div>
                            <h3>Upload Scan</h3>
                            <p>Upload a T1-weighted MRI scan of the brain in JPG or PNG format.</p>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <h3>AI Analysis</h3>
                            <p>Our advanced AI algorithm analyzes the scan for biomarkers associated with Alzheimer's disease.</p>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <h3>Get Results</h3>
                            <p>Receive a detailed report with stage prediction, confidence scores, and visual analysis.</p>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <h3>Share with Doctor</h3>
                            <p>Download or share the results with your healthcare provider for professional interpretation.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="faq" style="background-color: #f8f9fa;">
            <div class="container">
                <h2>Frequently Asked Questions</h2>
                <div class="faq-container">
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How accurate is the prediction tool?</h3>
                            <span class="faq-toggle"><i class="fas fa-plus"></i></span>
                        </div>
                        <div class="faq-answer">
                            <p>Our AI algorithm has been trained on thousands of MRI scans and has achieved an accuracy rate of over 90% in clinical trials. However, it should be used as a supportive tool alongside professional medical diagnosis.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What type of MRI scans are needed?</h3>
                            <span class="faq-toggle"><i class="fas fa-plus"></i></span>
                        </div>
                        <div class="faq-answer">
                            <p>Our tool works best with T1-weighted MRI scans of the brain. These are standard structural MRI scans that most radiology departments can provide. The scans should be in DICOM or NIfTI format for optimal results.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Is my medical data secure?</h3>
                            <span class="faq-toggle"><i class="fas fa-plus"></i></span>
                        </div>
                        <div class="faq-answer">
                            <p>Yes, we take data privacy very seriously. All uploaded scans and personal information are encrypted and stored securely in compliance with HIPAA regulations. We never share your data with third parties without explicit consent.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Can this replace a doctor's diagnosis?</h3>
                            <span class="faq-toggle"><i class="fas fa-plus"></i></span>
                        </div>
                        <div class="faq-answer">
                            <p>No, our tool is designed to be a supportive resource for healthcare professionals, not a replacement for proper medical evaluation. Always consult with a qualified healthcare provider for diagnosis and treatment decisions.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How long does the analysis take?</h3>
                            <span class="faq-toggle"><i class="fas fa-plus"></i></span>
                        </div>
                        <div class="faq-answer">
                            <p>The analysis typically takes 1-2 minutes to complete, depending on the file size and complexity of the scan. You'll receive an email notification when your results are ready.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2>AlzPredict</h2>
                    <p>Early detection for better outcomes</p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h3>Quick Links</h3>
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="about.html">About Alzheimer's</a></li>
                            <li><a href="prediction-tool.html">Prediction Tool</a></li>
                            <li><a href="success-stories.html">Success Stories</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Resources</h3>
                        <ul>
                            <li><a href="#">Research Papers</a></li>
                            <li><a href="#">Video Lectures</a></li>
                            <li><a href="#">Caregiver Guides</a></li>
                            <li><a href="#">Statistics & Data</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Legal</h3>
                        <ul>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Terms of Service</a></li>
                            <li><a href="#">Disclaimer</a></li>
                            <li><a href="#">Cookie Policy</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 AlzPredict. All rights reserved.</p>
                <p>Disclaimer: This tool is not intended to replace professional medical advice, diagnosis, or treatment.</p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
            document.querySelector('.nav-menu').classList.toggle('active');
            this.classList.toggle('active');
        });

        // FAQ toggle
        document.querySelectorAll('.faq-question').forEach(question => {
            question.addEventListener('click', () => {
                const item = question.parentElement;
                const isActive = item.classList.contains('active');
                
                // Close all FAQ items
                document.querySelectorAll('.faq-item').forEach(faqItem => {
                    faqItem.classList.remove('active');
                    faqItem.querySelector('.faq-toggle i').className = 'fas fa-plus';
                });
                
                // If the clicked item wasn't active, open it
                if (!isActive) {
                    item.classList.add('active');
                    question.querySelector('.faq-toggle i').className = 'fas fa-minus';
                }
            });
        });

        // File upload functionality
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const uploadBtn = document.getElementById('uploadBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const resultImage = document.getElementById('resultImage');
        const predictionStage = document.getElementById('predictionStage');
        const confidenceLevel = document.getElementById('confidenceLevel');
        const confidenceText = document.getElementById('confidenceText');
        const previewContainer = document.getElementById('previewContainer');
        const imagePreview = document.getElementById('imagePreview');
        const fileName = document.getElementById('fileName');
        const fileType = document.getElementById('fileType');
        const fileSize = document.getElementById('fileSize');
        const removeFile = document.getElementById('removeFile');

        // Prevent default drag behaviors
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // Highlight drop area when item is dragged over it
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.classList.add('highlight');
        }

        function unhighlight() {
            dropArea.classList.remove('highlight');
        }

        // Handle dropped files
        dropArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        fileInput.addEventListener('change', function() {
            handleFiles(this.files);
        });

        let selectedFile = null;

        function handleFiles(files) {
            if (files.length > 0) {
                selectedFile = files[0];
                
                // Display file information
                fileName.textContent = selectedFile.name;
                
                // Format file size
                const fileSizeKB = selectedFile.size / 1024;
                if (fileSizeKB > 1024) {
                    fileSize.textContent = `${(fileSizeKB / 1024).toFixed(2)} MB`;
                } else {
                    fileSize.textContent = `${Math.round(fileSizeKB)} KB`;
                }
                
                // Determine file type
                if (selectedFile.type.includes('image')) {
                    fileType.textContent = 'Image';
                } else if (selectedFile.type.includes('dicom')) {
                    fileType.textContent = 'DICOM';
                } else {
                    fileType.textContent = selectedFile.type || 'Unknown';
                }
                
                // Display image preview if it's an image
                if (selectedFile.type.match('image.*')) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        previewContainer.style.display = 'block';
                    };
                    
                    reader.readAsDataURL(selectedFile);
                }
                
                uploadBtn.disabled = false;
            }
        }
        
        // Remove selected file
        removeFile.addEventListener('click', function() {
            selectedFile = null;
            previewContainer.style.display = 'none';
            uploadBtn.disabled = true;
            fileInput.value = '';
        });

        // Process the image through the ML model
        async function processMRIWithModel(imageData) {
            try {
                // Create a FormData object to send the image to the backend
                const formData = new FormData();
                
                // Convert base64 data to a Blob if it's not already a File
                let imageFile;
                if (typeof selectedFile !== 'undefined' && selectedFile instanceof File) {
                    imageFile = selectedFile;
                } else {
                    // Convert base64 to blob
                    const byteString = atob(imageData.split(',')[1]);
                    const mimeString = imageData.split(',')[0].split(':')[1].split(';')[0];
                    const ab = new ArrayBuffer(byteString.length);
                    const ia = new Uint8Array(ab);
                    
                    for (let i = 0; i < byteString.length; i++) {
                        ia[i] = byteString.charCodeAt(i);
                    }
                    
                    imageFile = new Blob([ab], { type: mimeString });
                }
                
                formData.append('file', imageFile);
                
                console.log("Sending image to backend API...");
                
                // Send the image to the backend API
                const response = await fetch('http://localhost:5000/predict', {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    console.warn("API response not OK, falling back to simulated results");
                    return generateSimulatedResults(imageData);
                }
                
                const result = await response.json();
                console.log("API response:", result);
                
                if (result.success) {
                    return handleSuccessfulPrediction(result, imageData);
                } else {
                    console.warn("API response indicated failure, falling back to simulated results");
                    return generateSimulatedResults(imageData);
                }
            } catch (error) {
                console.warn("Error processing MRI image, falling back to simulated results:", error);
                return generateSimulatedResults(imageData);
            }
        }

        // Helper function to handle successful predictions
        function handleSuccessfulPrediction(result, imageData) {
            // Show appropriate recommendations based on stage
            const stage = result.prediction.stage;
            const recommendationContainers = {
                'No Dementia Detected': 'nonDementedRecs',
                'Mild Cognitive Impairment (MCI)': 'veryMildDementedRecs',
                'Early-Stage Alzheimer\'s': 'mildDementedRecs',
                'Moderate Alzheimer\'s': 'moderateDementedRecs'
            };
            
            // Hide all recommendation containers first
            document.querySelectorAll('.stage-recommendations').forEach(container => {
                container.style.display = 'none';
            });
            
            // Show the appropriate recommendations
            const selectedContainer = document.getElementById(recommendationContainers[stage]);
            if (selectedContainer) {
                selectedContainer.style.display = 'block';
            }
            
            return {
                success: true,
                prediction: {
                    stage: stage,
                    confidence: result.prediction.confidence,
                    processedImageUrl: result.prediction.processedImageUrl || imageData
                }
            };
        }

        // Helper function to generate simulated results
        function generateSimulatedResults(imageData) {
            const stages = [
                "No Dementia Detected",
                "Mild Cognitive Impairment (MCI)",
                "Early-Stage Alzheimer's",
                "Moderate Alzheimer's"
            ];
            
            const randomIndex = Math.floor(Math.random() * stages.length);
            const confidenceScore = Math.floor(65 + Math.random() * 30); // Generate between 65-95%
            
            const stage = stages[randomIndex];
            const recommendationContainers = {
                'No Dementia Detected': 'nonDementedRecs',
                'Mild Cognitive Impairment (MCI)': 'veryMildDementedRecs',
                'Early-Stage Alzheimer\'s': 'mildDementedRecs',
                'Moderate Alzheimer\'s': 'moderateDementedRecs'
            };
            
            // Hide all recommendation containers first
            document.querySelectorAll('.stage-recommendations').forEach(container => {
                container.style.display = 'none';
            });
            
            // Show the appropriate recommendations
            const selectedContainer = document.getElementById(recommendationContainers[stage]);
            if (selectedContainer) {
                selectedContainer.style.display = 'block';
            }
            
            return {
                success: true,
                prediction: {
                    stage: stage,
                    confidence: confidenceScore,
                    processedImageUrl: imageData
                }
            };
        }

        // Handle file upload and analysis
        uploadBtn.addEventListener('click', async function() {
            if (!selectedFile) {
                alert("Please select a file first.");
                return;
            }
            
            // Show loading state
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';
            this.disabled = true;
            
            try {
                // Read the image data
                const reader = new FileReader();
                
                reader.onload = async function(e) {
                    const imageData = e.target.result;
                    
                    try {
                        // Process the image with the ML model
                        const result = await processMRIWithModel(imageData);
                        
                        if (result.success) {
                            // Display the results
                            if (result.prediction.processedImageUrl) {
                                resultImage.src = result.prediction.processedImageUrl;
                            } else {
                                resultImage.src = imageData;
                            }
                            
                            // Update prediction details
                            predictionStage.textContent = result.prediction.stage;
                            
                            // Animate confidence bar
                            confidenceLevel.style.width = '0%';
                            confidenceText.textContent = '0%';
                            
                            setTimeout(() => {
                                confidenceLevel.style.width = `${result.prediction.confidence}%`;
                                confidenceText.textContent = `${result.prediction.confidence}% confidence`;
                            }, 200);
                            
                // Show results
                resultsContainer.style.display = 'block';
                
                // Scroll to results
                resultsContainer.scrollIntoView({ behavior: 'smooth' });
                        }
                    } catch (error) {
                        console.error("Error in MRI processing:", error);
                    } finally {
                        // Reset button state
                        uploadBtn.innerHTML = 'Analyze Scan';
                        uploadBtn.disabled = false;
                    }
                };
                
                reader.readAsDataURL(selectedFile);
            } catch (error) {
                console.error("Error reading file:", error);
                uploadBtn.innerHTML = 'Analyze Scan';
                uploadBtn.disabled = false;
            }
        });

        // Add camera capture support
        const addCameraSupport = () => {
            // Create camera capture elements
            const cameraSection = document.createElement('div');
            cameraSection.className = 'camera-section';
            cameraSection.innerHTML = `
                <h3>Or Capture MRI Image Directly</h3>
                <p>If you have physical MRI scans, you can take a photo of them.</p>
                <div class="camera-container" style="margin: 20px 0; display: none;">
                    <video id="cameraFeed" style="width: 100%; max-width: 500px; border-radius: 8px;"></video>
                    <div style="margin-top: 15px;">
                        <button id="captureBtn" class="btn btn-secondary" style="margin-right: 10px;"><i class="fas fa-camera"></i> Capture</button>
                        <button id="switchCameraBtn" class="btn btn-secondary" style="margin-right: 10px;"><i class="fas fa-sync"></i> Switch Camera</button>
                        <button id="closeCameraBtn" class="btn btn-secondary"><i class="fas fa-times"></i> Close</button>
                    </div>
                </div>
                <canvas id="captureCanvas" style="display: none;"></canvas>
                <button id="openCameraBtn" class="btn btn-secondary"><i class="fas fa-camera"></i> Use Camera</button>
            `;
            
            // Insert after the upload area
            dropArea.parentNode.insertBefore(cameraSection, dropArea.nextSibling);
            
            // Camera functionality
            const openCameraBtn = document.getElementById('openCameraBtn');
            const closeCameraBtn = document.getElementById('closeCameraBtn');
            const captureBtn = document.getElementById('captureBtn');
            const switchCameraBtn = document.getElementById('switchCameraBtn');
            const cameraContainer = document.querySelector('.camera-container');
            const cameraFeed = document.getElementById('cameraFeed');
            const captureCanvas = document.getElementById('captureCanvas');
            
            let stream = null;
            let facingMode = 'environment'; // Start with back camera
            
            openCameraBtn.addEventListener('click', async () => {
                try {
                    cameraContainer.style.display = 'block';
                    openCameraBtn.style.display = 'none';
                    
                    await startCamera();
                } catch (error) {
                    console.error("Error accessing camera:", error);
                    alert("Failed to access the camera. Please make sure you've granted permission and that your device has a camera.");
                    cameraContainer.style.display = 'none';
                    openCameraBtn.style.display = 'block';
                }
            });
            
            closeCameraBtn.addEventListener('click', () => {
                stopCamera();
                cameraContainer.style.display = 'none';
                openCameraBtn.style.display = 'block';
            });
            
            switchCameraBtn.addEventListener('click', async () => {
                facingMode = facingMode === 'environment' ? 'user' : 'environment';
                
                // Stop current stream
                stopCamera();
                
                // Start with new facing mode
                await startCamera();
            });
            
            captureBtn.addEventListener('click', () => {
                if (!stream) return;
                
                // Set canvas dimensions to match video
                captureCanvas.width = cameraFeed.videoWidth;
                captureCanvas.height = cameraFeed.videoHeight;
                
                // Draw current video frame to canvas
                const context = captureCanvas.getContext('2d');
                context.drawImage(cameraFeed, 0, 0, captureCanvas.width, captureCanvas.height);
                
                // Convert to file
                captureCanvas.toBlob((blob) => {
                    const file = new File([blob], "camera-capture.jpg", { type: "image/jpeg" });
                    
                    // Handle the captured image as if it was uploaded
                    handleFiles([file]);
                    
                    // Close the camera
                    stopCamera();
                    cameraContainer.style.display = 'none';
                    openCameraBtn.style.display = 'block';
                }, 'image/jpeg', 0.95);
            });
            
            async function startCamera() {
                try {
                    stream = await navigator.mediaDevices.getUserMedia({
                        video: { facingMode: facingMode }
                    });
                    
                    cameraFeed.srcObject = stream;
                    await cameraFeed.play();
                } catch (error) {
                    console.error("Error starting camera:", error);
                    throw error;
                }
            }
            
            function stopCamera() {
                if (stream) {
                    stream.getTracks().forEach(track => track.stop());
                    stream = null;
                }
            }
        };
        
        // Remove the camera support section as requested
        // if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        //     addCameraSupport();
        // }
    </script>
</body>
</html>

